#!/bin/sh
dte(){
        dte="$(date +"%a, %b %d %R")"
        echo "$dte"
}

hdd(){
        hdd="$(df -h /home | grep dev | awk '{print$3, " "  $5}')"
        echo "disk: $hdd"
}

mem(){
        mem="$(free -h | awk '/Mem:/ {printf $3 " / " $2}')"
        echo "ram: $mem"
}

cpu() {
    read cpu a b c previdle rest < /proc/stat
      prevtotal=$((a+b+c+previdle))
        sleep 0.5
          read cpu a b c idle rest < /proc/stat
            total=$((a+b+c+idle))
              cpu=$((100*( (total-prevtotal) - (idle-previdle) ) / (total-prevtotal) ))
                echo "cpu: $cpu% "
}

pkgs(){
        pkgs="$(eix-installed -a | wc -l)"
        echo "pkgs: $pkgs"
}

vpn(){
        vpn="$(ip a | grep tun0 | grep inet | wc -l)"
        echo "vpn: $vpn"
}

#vol(){
#	vol="$(amixer -D pulse get Master | awk -F'[][]' 'END{print $4":"$2}')"
#	echo "Volume $vol"
#}

kernel(){
	kernel="$(uname -sr | sed "s/-amd64//g")"
	echo $kernel 
}

status(){
	echo "$(cpu) | $(mem) | $(hdd) | $(pkgs) | $(vpn) | $(dte)"
}

while true; do
	xsetroot  -name "$(status)"
	sleep 30
done
